var w=Object.defineProperty,f=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var u=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var h=(s,t,e)=>t in s?w(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,m=(s,t)=>{for(var e in t||(t={}))S.call(t,e)&&h(s,e,t[e]);if(u)for(var e of u(t))_.call(t,e)&&h(s,e,t[e]);return s},l=(s,t)=>f(s,y(t));import{O as k,C as A}from"./vendor-19c148b2.js";const I="",v="",C=(s,t=I,e=v)=>({send:{amount:s,recipient:t,recipient_code_hash:e,msg:"eyJyZWNlaXZlX21pbnQiOnt9fQ=="}}),b={exec:{gas:"500500"}},g=A([]),x="https://secret-4.api.trivium.network:1317",F="secret1k0jntykt7e4g3y88ltc60czgjuqdy4c9e8fzek",P=s=>new Promise(t=>setTimeout(t,s)),E=async(s,t,e=1200)=>{let n=0;for(;s();){if(n+=50,n>e)throw Error(t);await P(50)}};class O{constructor(t=!1,e="secret-4",n="secret1ac2kufxkz9gz9dhfgdgxhrp8yh2ty6g73udrde",i="45AD7D178E0B071B1F54C3FBA8BF3CFF77DDEC92FFABB308F9E8D7A7C62EDBB6"){if(this.connected=t,this.chainId=e,this.contractAddress=n,this.contractHash=i,this.address="",this.permitParams={permit_name:"hunter_permit",allowed_tokens:[this.contractAddress],permissions:["owner"]},typeof window!="undefined"){t=localStorage.getItem("connected")==="true";const c=localStorage.getItem("signature");c&&(this.signature=JSON.parse(c))}}async setupKeplr(){await E(()=>!window.keplr&&!window.getOfflineSigner&&!window.getEnigmaUtils,"Couldn't connect to Keplr. Make sure it is installed"),await window.keplr.enable(this.chainId);const t=window.getOfflineSigner(this.chainId),e=await t.getAccounts();this.address=e[0].address,this.client=new k(x,this.address,t,window.getEnigmaUtils(this.chainId),b),this.connected=!0,localStorage.setItem("connected","true")}async getSignature(){const{signature:t}=await window.keplr.signAmino(this.chainId,this.address,{chain_id:this.chainId,account_number:"0",sequence:"0",fee:{amount:[{denom:"uscrt",amount:"0"}],gas:"1"},msgs:[{type:"query_permit",value:this.permitParams}],memo:""},{preferNoSetFee:!0,preferNoSetMemo:!0});return this.signature=t,localStorage.setItem("signature",JSON.stringify(t)),t}async customQueryPermit(t){var i;const e={with_permit:{query:t,permit:{params:l(m({},this.permitParams),{chain_id:this.chainId}),signature:(i=this.signature)!=null?i:await this.getSignature()}}};return await this.client.queryContractSmart(this.contractAddress,e)}async customQuery(t){return await this.client.queryContractSmart(this.contractAddress,t)}async getToken(t){return await this.customQueryPermit({nft_dossier:{token_id:t}})}async transfer(t,e){return await this.client.execute(this.contractAddress,{transfer_nft:{token_id:t,recipient:e}},void 0,void 0,{gas:"42000"})}async getTokens(t=!1){if(!t){const i=localStorage.getItem("hunters");if(i){const r=JSON.parse(i);return g.update(()=>r),r}}const e=await this.customQueryPermit({tokens:{owner:this.address}}),n=[];return await Promise.allSettled(e.token_list.tokens.map(i=>new Promise(async(r,c)=>{const d=await this.customQueryPermit({nft_dossier:{token_id:i}}),a={id:i,image:d.nft_dossier.public_metadata.extension.media[0].url};d.nft_dossier.public_metadata.extension.attributes.forEach(o=>{a[o.trait_type]=o.value});const p=d.nft_dossier.private_metadata.extension.attributes[0];a["Eaten Count"]=p.value,n.push(a),g.update(o=>[...o,a]),r(a)}))),localStorage.setItem("hunters",JSON.stringify(n)),n}async mint(t,e){return await this.client.execute(F,C(t,this.contractAddress,this.contractHash),void 0,void 0,{gas:e})}async hunt(t,e){return await this.client.execute(this.contractAddress,{eat:{eater_id:t,food_id:e}},void 0,void 0,{gas:"42000"})}}const N=new O;export{g as l,E as t,N as w};
